# This Sourcehut job script has been generated by a script via
#
#   haskell-ci 'sourcehut' 'dual-game.cabal' '--source' 'https://github.com/fgaz/dual' '--apt' 'zlib1g-dev' '--apt' 'libgl-dev' '--apt' 'libglu-dev' '--no-haddock'
#
# To regenerate the script (for example after adjusting tested-with) run
#
#   haskell-ci regenerate
#
# For more information, see https://github.com/haskell-CI/haskell-ci
#
# version: 0.13.20211116
#
# REGENDATA ("0.13.20211116",["sourcehut","dual-game.cabal","--source","https://github.com/fgaz/dual","--apt","zlib1g-dev","--apt","libgl-dev","--apt","libglu-dev","--no-haddock"])
#
image: ubuntu/bionic
packages:
  - gcc
  - cabal-install-3.4
  - ghc-8.0.2
  - ghc-8.2.2
  - ghc-8.4.4
  - ghc-8.6.5
  - ghc-8.8.4
  - ghc-8.10.4
  - ghc-9.0.1
  - libgl-dev
  - libglu-dev
  - zlib1g-dev
repositories:
  hvr-ghc: http://ppa.launchpad.net/hvr/ghc/ubuntu bionic main ff3aeacef6f88286
sources:
  - https://github.com/fgaz/dual
tasks:
  - all-prepare: |
      export PATH=$PATH:/opt/cabal/bin
      echo "export PATH=$PATH:/opt/cabal/bin" >> ~/.buildenv
      cabal update
  - 8_0_2-prepare: |
      cd dual
      cabal configure -w /opt/ghc/bin/ghc-8.0.2
  - 8_0_2-check: |
      cd dual
      cabal check
  - 8_0_2-dependencies: |
      cd dual
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_0_2-build: |
      cd dual
      cabal build all
  - 8_0_2-test: |
      cd dual
      cabal test all --enable-tests
  - 8_2_2-prepare: |
      cd dual
      cabal configure -w /opt/ghc/bin/ghc-8.2.2
  - 8_2_2-check: |
      cd dual
      cabal check
  - 8_2_2-dependencies: |
      cd dual
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_2_2-build: |
      cd dual
      cabal build all
  - 8_2_2-test: |
      cd dual
      cabal test all --enable-tests
  - 8_4_4-prepare: |
      cd dual
      cabal configure -w /opt/ghc/bin/ghc-8.4.4
  - 8_4_4-check: |
      cd dual
      cabal check
  - 8_4_4-dependencies: |
      cd dual
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_4_4-build: |
      cd dual
      cabal build all
  - 8_4_4-test: |
      cd dual
      cabal test all --enable-tests
  - 8_6_5-prepare: |
      cd dual
      cabal configure -w /opt/ghc/bin/ghc-8.6.5
  - 8_6_5-check: |
      cd dual
      cabal check
  - 8_6_5-dependencies: |
      cd dual
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_6_5-build: |
      cd dual
      cabal build all
  - 8_6_5-test: |
      cd dual
      cabal test all --enable-tests
  - 8_8_4-prepare: |
      cd dual
      cabal configure -w /opt/ghc/bin/ghc-8.8.4
  - 8_8_4-check: |
      cd dual
      cabal check
  - 8_8_4-dependencies: |
      cd dual
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_8_4-build: |
      cd dual
      cabal build all
  - 8_8_4-test: |
      cd dual
      cabal test all --enable-tests
  - 8_10_4-prepare: |
      cd dual
      cabal configure -w /opt/ghc/bin/ghc-8.10.4
  - 8_10_4-check: |
      cd dual
      cabal check
  - 8_10_4-dependencies: |
      cd dual
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_10_4-build: |
      cd dual
      cabal build all
  - 8_10_4-test: |
      cd dual
      cabal test all --enable-tests
  - 9_0_1-prepare: |
      cd dual
      cabal configure -w /opt/ghc/bin/ghc-9.0.1
  - 9_0_1-check: |
      cd dual
      cabal check
  - 9_0_1-dependencies: |
      cd dual
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 9_0_1-build: |
      cd dual
      cabal build all
  - 9_0_1-test: |
      cd dual
      cabal test all --enable-tests
triggers:
  - action: email
    condition: failure
    to: Francesco Gazzetta <fgaz@fgaz.me>
